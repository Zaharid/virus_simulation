<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="An amateur virus propagation simulation, for educational purposes.">
    <meta name="author" content="Zahari Kassabov">
    <title>Virus propagation simulation</title>
    <style>
        #urlshare {
            width: 100%;
        }

        footer {
            padding-top: 3rem;
            padding-bottom: 3rem;
        }

        fieldset fieldset {
            margin-left: 3rem;
            margin-right: 3rem;
        }

        footer p {
            margin-bottom: .25rem;
        }

        .flexinp {
            display: flex;
            margin-right: 10px;
        }

        .flextextinp {
            flex-grow: 1;
        }

        .time-profile-input {
            width: 99%;
        }

        .reset-inp-btn {
            flex-grow: 0;
        }

        .time-profile-vis {
            width: 100%;
            margin-bottom: 20px;
        }

        .core-vis {
            width: 100%;
        }

        .doc-container {
            background-color: white;
        }


        .multiply-inp {
            width: 3em;
        }

        figure {
            text-align: center;
            padding-bottom: 2rem;
        }

        figure>img {
            max-width: 100%;
            height: auto;
        }

        #policy-collapse {
            padding-bottom: 3em;
        }

        .anchor-link:before {
            content: "⚙";

        }

        label,
        input {
            /* In order to define widths */
            display: inline-block;
        }

        label {
            width: 30%;
            /* Positions the label text beside the input */
            text-align: center;
        }

        label+input {
            width: 30%;
            /* Large margin-right to force the next element to the new-line
            and margin-left to create a gutter between the label and input */
            margin: 0 30% 0 4%;
        }

        ​

        /*
       Disable spinners https://stackoverflow.com/questions/3790935/can-i-hide-the-html5-number-input-s-spin-box
     */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            /* display: none; <- Crashes Chrome on hover */
            -webkit-appearance: none;
            margin: 0;
            /* <-- Apparently some margin are still there even though it's hidden */
        }

        input[type=number] {
            -moz-appearance: textfield;
            /* Firefox */
        }
    </style>
</head>

<body>
    <noscript>This page contains webassembly and javascript content, please enable javascript in your
        browser.</noscript>
    <main>
        <section class="jumbotron text-center">
            <h1> A virus propagation simulation</h1>
            <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#doc-collapse">Model description</button>
            <div class="collapse container" id="doc-collapse">
                <div class="row doc-container p-lg-5 m-lg-4">
                    <div class="col-md-12 text-left">
                        <h3 id="about">About</h3>
                        <p>This is a simulation of a simplified model of epidemic response which attempts to account for both dynamics of disease propagation, the saturation of the healthcare system, and the effect of policy responses. The default parameters and the choice of policies attempt to describe the current Covid-19 crisis.</p>
                        <p>The user interface allows users to choose when to set policies as a response to the development of the disease and to vary multiple parameters.</p>
                        <p>The simulation can be viewed as an educational tool, and allows to visualize the impact of the pandemic as a function of both policy choices and yet unknown characteristics of the disease. However please do read the disclaimer below.</p>
                        <h3 id="important-disclaimer">Important disclaimer</h3>
                        <p>I am not an epidemiologist and I am mostly using my undergraduate-level knowledge in this work. Some attempts by particle physicist to produce models for the coronavirus situation <a href="https://www.science20.com/tommaso_dorigo/the_virus_that_turns_physicists_into_crackpots-246490">have been rather schlocky</a> and have led to far too strong wrong conclusions resting wobbly grounds. This simulation is emphatically not a research project, and has no aspirations to predict the future. The modelling is simplistic and both the choice the model itself and default parameters reflect my own biases and lack of knowledge. For example different age groups are not modelled because I don’t really know what would look like (and don’t know that such policy has been applied particularly effectively anywhere in the world).</p>
                        <p>That said, I do believe this is an useful exercise for myself and hopefully others. Rather that making predictions for the future, I have tried to explain to myself the current policy debate and, hopefully in a way that can be useful to others.</p>
                        <p>I believe the utility of this project is twofold:</p>
                        <ul>
                            <li>
                                <p>Ascertain that the outcome of the models are hugely dependent on parameters that are currently not well known, such as the proportion of undetected asymptomatic cases, or the long term immunity. Any certain claims coming from modelling should come with good explanations on how the parameters are fixed, and what the actual uncertainty on the conclusions is. Indeed different modelling efforts, including those done by dedicated teams from renowned organizations can reach vastly different conclusions, which in turn can <a href="https://bylinetimes.com/2020/03/23/covid-19-special-investigation-part-one-the-politicised-science-that-nudged-the-johnson-government-to-safeguard-the-economy-over-british-lives/">greatly impact government action</a>.</p>
                            </li>
                            <li>
                                <p>Serve as an education tool that allows public to recognize the merit and critically evaluate the need various public policy proposals.</p>
                            </li>
                        </ul>
                        <h3 id="the-model">The model</h3>
                        <p>The simulation tracks the evolution of a set of agents, which could model the population of a city. Each agent is in one of the following states:</p>
                        <ul>
                            <li>Susceptible</li>
                            <li>Infected (Undetected)</li>
                            <li>Infected (Detected)</li>
                            <li>Severe</li>
                            <li>Unattended</li>
                            <li>Immune</li>
                            <li>Dead</li>
                        </ul>
                        <p>The evolution proceeds in discrete time events, <em>days</em>. On each day, agents can transition between stated according to</p>
                        <figure>
                            <img src="flow.svg" alt="Diagram of transitions between different states" />
                            <figcaption>Diagram of transitions between different states</figcaption>
                        </figure>
                        <p>The model is similar to <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology">commonly used simplified descriptions</a>, but placing more emphasis in aspects that are relevant to the current crisis, such as hospital saturation or the propagation of the disease by asymptomatic carriers. It also used a <a href="https://en.wikipedia.org/wiki/Complex_network">complex network</a> to model the disease propagation among different types of contacts. Many settings of the simulation can be controlled trough the <a class="anchor-link" data-target="#configure-collapse" href="#configure-lead">Configure Simulation interface</a>. In particular it allows to set probabilities for the various transitions as a function of time.</p>
                        <div class="alert alert-secondary">
                            <p>Note: Transition chances are parametrized as the probability of a given transition happening assuming no other transition has happened that day. When there are several possible transitions from one state to others (for example a Severe agent can become either Dead or Immune), the probability of no transition is fixed (as the product of probabilities of each of the possible transitions not happening). A random number then decides whether the agent stays in the same state or some of the possible transitions occur. If any transition does happen, the probability of each possible transition is proportional to the user entered setting.</p>
                            <p>For example if on a given day the probability of the transition Severe -&gt; Immune is 80% (as entered by the user, that is, assuming no other transitions happen) and the probability Severe -&gt; Dead is 20%, the actual transition probabilities are:</p>
                            <ul>
                                <li>Severe -&gt; Severe (no transition): 16%</li>
                                <li>Severe -&gt; Immune: 67.2%</li>
                                <li>Severe -&gt; Dead: 16.8%</li>
                            </ul>
                            <p>When probabilities are sufficiently small, the difference is negligible. For example if instead the independent transition probabilities are 8% for the Severe -&gt; Immune transition and 2% for the Severe -&gt; Dead transition, the actual probabilities are</p>
                            <ul>
                                <li>Severe -&gt; Severe (no transition): 90.16%</li>
                                <li>Severe -&gt; Immune: 7.872%</li>
                                <li>Severe -&gt; Dead: 1.968%</li>
                            </ul>
                            <p>This way of parametrizing has the advantage of allowing to think of probabilities of the various transitions as if they were independent and not having to worry that they e.g. add up to 100%.</p>
                        </div>
                        <p>The dynamics of each possible transition as well as the relevant settings that control them are described next.</p>
                        <h4 id="disease-propagation">Disease propagation</h4>
                        <p>The probability of an Infected agent to transmit the disease to a Susceptible one depends on the number of days elapsed since the infection (which models the development of the disease), whether the agent is Detected or Undetected (which is assumed to make people behave differently) on the interactions with other agents.</p>
                        <p>The interactions leading to infection are modelled in terms of a set of networks (<a href="https://en.wikipedia.org/wiki/Graph_(discrete_mathematics)#Undirected_graph">undirected graphs</a>): Agents are arranged in three levels of networks:</p>
                        <ul>
                            <li>Household network</li>
                            <li>Workplace network</li>
                            <li>World network</li>
                        </ul>
                        <p>The disease spreads from Infected (Detected or Undetected) to Susceptible agents that are connected to them by some of the networks.</p>
                        <p>Each agent is assigned to one household and one workplace, and it is connected to the unique World network, which models the random infection-risking interactions between the population. Each network is associated to different infectability strengths, for either Detected or Undetected Infected agents, expressed as a percentage of some max some maximum daily infectability. By default it is assumed that the infectability is strongest for <a
                                class="anchor-link" href=#family_contact_undetected_coef>Undetected agents in Household interactions</a> (and the strength is set to 100% by convention), and the Household infectability decrease relatively little when a patient is <a
                                class="anchor-link" href="#family_contact_detected_coef">known to be infected</a>. <a class="anchor-link"
                                href="#workplace_contact_undetected_coef">Workplace</a> and <a
                                class="anchor-link" href="#world_contact_undetected_coef">World</a> infectability strengths are lower, and also decrease strongly when a patient is known to be infected. All strengths are tunable, and also can be influenced by policy choices.</p>
                        <p>Each household network is a <a href="https://en.wikipedia.org/wiki/Complete_graph">fully connected</a> graph. The distribution of household sizes <a class="anchor-link" href="#family_sizes">can be controlled explicitly</a>.</p>
                        <p>The size of each workplace follows a <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a> where the average size of the workplaces <a class="anchor-link"
                                href="#average_workplace_size">is controlled by the user</a>. This is the result of assigning each agent to a workplace at random, with equal probability, with the number of workplaces being chosen to reflect the mean size set by the user.</p>
                        <p>Each workplace network as well as the world network are <a href="https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93R%C3%A9nyi_model">Erdős–Rényi networks</a>: That is, each pair of nodes is connected with an independent, constant, probability. By default <a class="anchor-link"
                                hfref="#workplace-connectivity">Workplace connectivity</a> is almost full, and World connectivity expressed in terms of the number of <a class="anchor-link"
                                href="#average_world_connections">average daily interactions</a> with random agents, is lower, yet high enough to ensure that the network is almost surely <a href="https://en.wikipedia.org/wiki/Connectivity_%28graph_theory%29#Connected_graph">connected</a> (that is there exists an indirect path in the World network between each pair of agents, implying that it is possible that every agent gets infected through the World network).</p>
                        <p>Currently all of the networks stay fixed throughout the simulation.</p>
                        <p>The infection rates are then computed as follow: On a given day, each Susceptible agent has a probability of getting becoming infected for each of the Infected agents it is connected to in all of the three networks. The infection probabilities are independent and the Susceptible agent becomes Infected (Undetected) if any single of its daily interactions results in an infection. The infection probability is the product of a <a
                                href="#susceptible_infected_profile" class="anchor-link">factor</a> dependent on the disease (specifically on the number of says since infection, and which can be set by the user) and a strength factor depending on the type of network that mediated the interaction (Household, Workplace or World) and whether the Infected agent was Detected or Undetected.</p>
                        <p>At the beginning of the simulation <a class="anchor-link"
                                href="#initial_outbreak_size"> a few</a> agents start off as Infected (Undetected), while the rest of the population is Susceptible. The disease then spreads across the networks.</p>
                        <h4 id="detection">Detection</h4>
                        <p>Each Infected (Undetected) agent has a <a class="anchor-link"
                                href="#infected_detected_profile">daily probability</a> of becoming Detected spontaneously. This probability varies as a function of the number of says since infection and is settable by the user. This models people assuming they have contracted the disease, for example based on their symptoms. It is assumed that the disease evolution is not affected by whether the agent is Detected or Undetected, but however it their behaviour changes (for example they largely stop going to work) leading to a smaller risk of infecting others. This is parametrized by the infectability strengths explained above.</p>
                        <h4 id="disease-evolution">Disease evolution</h4>
                        <p>Infected agents have a daily chance <a class="anchor-link"
                                href="#ingected_immune_profile">healing</a> (thus becoming Immune) or <a
                                class="anchor-link" href="#infected_severe_profile">worsen</a> and require hospital assistance. These chances depend on the number of days elapsed since the agent became Infected. Agents that have worsened and can be attended in the hospital become Severe, and Unattended if hospitals are saturated, as described next. Severe patients have a daily chance of <a class="anchor-link"
                                href="#severe_immune_profile">healing</a> and becoming Immune and a daily chance of becoming <a class="anchor-link" href="#severe_dead_profile">Dead</a>. The probabilities for each day since hospitalization can be set individually.</p>
                        <h4 id="hospital-resources">Hospital resources</h4>
                        <p>Hospital resource scarcity is modelled by the <a class="anchor-link"
                                href="#hospital_capacity">total number of patients that can be hospitalized at once</a>. If an agent requires hospitalization and the number of Severe patients matches this threshold, then the agent becomes Unattended. The next day unattended agents become Severe if there are hospital slots available or Dead otherwise.</p>
                        <div class="alert alert-secondary">
                            <p>Note: For simplicity Severe and Unattended agents are typically reported together in the user interface.</p>
                        </div>
                        <h4 id="immunity-loss">Immunity loss</h4>
                        <p>The simulation allows for the possibility of immune agents losing their immunity and becoming immune again. This is parametrized by a <a class="anchor-link"
                                href="#immune_susceptible_profile">daily probability</a> of becoming Susceptible as a function of the number of days since infection.</p>
                        <h3 id="policy-choices">Policy choices</h3>
                        <p>The simulation allows to estimate the effects of policies that influence the disease propagation and are implemented as a response to various events. Specifically policies can be triggered as a response of agents in a given state (for example Detected cases, Severe patients that need hospitalization or Dead agents) exceeding (or, alternatively, falling short of) a threshold set by the user.</p>
                        <p>The policies are configurable through the set policies menu <a
                                class="anchor-link" data-target="#policy-collapse" href="#policy-lead">Set policies menu</a>. The currently available policies are described next.</p>
                        <h4 id="shut-workplace">Shut workplace</h4>
                        <p>A given percentage of workplaces shut down completely and workplace virus transition trough them is eliminated.</p>
                        <h4 id="social-distancing">Social distancing</h4>
                        <p>Agents become more generally aware of the disease and infection rates both at the workplace and in random contacts decrease by an amount set by the user.</p>
                        <h3 id="technical-details">Technical details</h3>
                        <p>The code of the simulation can be found here:</p>
                        <p><a href="https://github.com/Zaharid/virus_simulation/" class="uri">https://github.com/Zaharid/virus_simulation/</a></p>
                        <p>The simulation runs entirely on the client browser and does not interact with a server or store any user data.</p>
                    </div>
                    <div class="col-md-12">
                        <button type="button" class="btn btn-secondary" data-toggle="collapse" data-target="#doc-collapse">Collapse</button>
                    </div>

                </div>
            </div>
            <p id="policy-lead" class="lead">
                Test the effect of public health policies on a simple model <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#policy-collapse">Set policies</button>
            </p>
            <div class="collapse" id="policy-collapse">
                <div class="container">
                    <div class="card-body" id="policy-container">
                        <div class="py-3 border policy-selector">
                            <div class="col-md-10 offset-md-2">
                                <form class="was-validated trigger-form" novalidate>
                                    <fieldset class="border">
                                        <legend class="w-auto">Trigger</legend>

                                        <select name="trigger-variable">
                                            <option value="Severe">Severe</option>
                                            <option value="Dead">Dead</option>
                                            <option value="Infected (Undetected)">Infected (Undetected)</option>
                                            <option value="Infected (Detected)">Infected (Detected)</option>
                                            <option value="Immune">Immune</option>
                                            <option value="Susceptible">Susceptible</option>
                                        </select>
                                        <select name="trigger-operator">
                                            <option value=">=">≥</option>
                                            <option value="<=">≤</option>
                                        </select>
                                        <input type="number" name="trigger-value" required>
                                        <div class="invalid-feedback">
                                            Please enter a valid number.
                                        </div>
                                    </fieldset>
                                </form>
                            </div>
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="nav flex-column nav-pills policy-select" role="tablist" aria-orientation="vertical">
                                        <a class="nav-link" id="pill-shut-workplaces" href="#form-shut-workplaces" data-toggle="pill" role="tab" aria-controls="form-shut-workplaces" aria-selected="false">Shut workplaces</a>
                                        <a class="nav-link" id="pill-social-distancing" href="#form-social-distancing" data-toggle="pill" role="tab" aria-controls="form-social-distancing" aria-selected="false">Social distancing</a>
                                    </div>
                                </div>
                                <div class="tab-content col-md-10">
                                    <div class="tab-pane active align-middle h-100">Select a policy</div>
                                    <div class="tab-pane fade" id="form-shut-workplaces" role="tabpanel" aria-labelledby="pill-shut-workplaces">
                                        <form class="was-validated policy-form" data-policy="shut-workplaces" novalidate>
                                            <fieldset class="border">
                                                <legend class="w-auto">Shut workplaces</legend>
                                                <label> Percentage of workplaces
                                                    <input type="number" min="0" max="100" step="any" value="50"
                                                        title="Percentage of workplaces to be closed completely"
                                                        imdata-units="percent" name="workplaces" required>
                                                    <div class="invalid-feedback">
                                                        Please enter a number between 0 and 100.
                                                    </div>
                                                </label>
                                            </fieldset>
                                        </form>
                                    </div>
                                    <div class="tab-pane fade" id="form-social-distancing" role="tabpanel" aria-labelledby="pill-social-distancing">
                                        <form class="was-validated policy-form" data-policy="social-distancing" novalidate>
                                            <fieldset class="border">
                                                <legend class="w-auto">Social distancing</legend>
                                                <label>General Infectability reduction percentage
                                                    <input type="number" min="0" max="100" step="any" title="Percentage reduction in infectability on random iterations"
                                                        value="70" data-units="percent" name="world-reduction" required>
                                                    <div class="invalid-feedback">
                                                        Please enter a number between 0 and 100.
                                                    </div>
                                                </label>
                                                <label>Workplace infectability reduction percentage
                                                    <input type="number" min="0" max="100" step="any" title="Percentage reduction in infectability with coworkers"
                                                        value="30" data-units="percent" name="workplace-reduction" required>
                                                    <div class="invalid-feedback">
                                                        Please enter a number between 0 and 100.
                                                    </div>
                                                </label>

                                            </fieldset>

                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-12">
                        <button id="add-another-policy" class="btn btn-info">Add policy</button>
                        <button id="remove-policy" class="btn btn-danger">Remove last</button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 py-3">
                        <button id="policies-close"
                            data-toggle="collapse" data-target="#policy-collapse" aria-expanded="false"
                            aria-controls="#configure-collaprole=" button"se" type="button" class="btn btn-secondary">Done</button>
                        <div id="policies-feedback" class="invalid-feedback">
                            Please enter valid data
                        </div>
                    </div>
                </div>
            </div>
            <p id="configure-lead" class="lead">
                Explore the dependency on the assumptions <butto class="btn btn-secondary" type="button"
                    data-toggle="collapse" data-target="#configure-collapse" aria-expanded="false"
                    aria-controls="configure-collapse">Configure Simulation</button>
            </p>
            <div class="collapse" id="configure-collapse">
                <div class="container">
                    <div class="card-body">
                        <form id="configure-form" class="was-validated" novalidate>
                            <fieldset class="border">
                                <legend class="w-auto">Virus Characteristics</legend>
                                <div class="form-group time-profile-group">
                                    <label for="susceptible_infected_profile">Infectablity profile</label>
                                    <div class="flexinp">
                                        <div class="flextextinp">
                                            <input name="susceptible_infected_profile" id="susceptible_infected_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Percent probability that an infected person spreads the disease to each contact on a given day, further weighted by the stregths defined below. The last value is repeated indefinitely." required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>
                                        </div>
                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="susceptible-infected-vis" data-ylabel="Probability(%)/contact/weight" data-xlabel="day since infection" class="time-profile-vis"></div>
                                </div>
                                <div class="form-group time-profile-group">
                                    <label for="infected_detected_profile">Detection profile</label>
                                    <div class="flexinp">
                                        <div class="flextextinp">
                                            <input name="infected_detected_profile" id="infected_detected_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Percent probability per day that an undetected infected patient will be detected." required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>

                                        </div>

                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="infected-detected-vis" data-xlabel="day since infection" class="time-profile-vis"></div>
                                </div>
                                <div class="form-group time-profile-group">
                                    <label for=infected_severe_profile>Worsening profile</label>
                                    <div class="flexinp">
                                        <div class="flextextinp">

                                            <input name="infected_severe_profile" id="infected_severe_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Probability per day that an infected patient becomes critical and requires hospitalization." required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>
                                        </div>

                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="infected-severe-vis" data-xlabel="day since infection" class="time-profile-vis"></div>
                                </div>
                                <div class="form-group time-profile-group">
                                    <label for=infected_immune_profile>Infected healing profile</label>
                                    <div class="flexinp">
                                        <div class="flextextinp">

                                            <input name="infected_immune_profile" id="infected_immune_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Percent probability per day that an infected patient heals and becomes immune" required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>
                                        </div>
                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="infected-immune-vis" data-xlabel="day since infection" class="time-profile-vis"></div>
                                </div>
                                <div class="form-group time-profile-group">
                                    <label for="severe_immune_profile">Severe healing profile</label>
                                    <div class="flexinp">
                                        <div class="flextextinp">
                                            <input name="severe_immune_profile" id="severe_immune_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Percent probability  per day that an hospitalized patient heals and becomes immune" required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>
                                        </div>
                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="severe-inumne-vis" data-xlabel="day since hospitalization" class="time-profile-vis"></div>
                                </div>
                                <div class="form-group time-profile-group">
                                    <label for="severe_dead_profile">Severe mortality profile</label>
                                    <div class="flexinp">
                                        <div class="flextextinp">
                                            <input name="severe_dead_profile" id="severe_dead_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Probability per day than an hospitalized patient deceases." required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>
                                        </div>
                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="infected-severe-vis" data-xlabel="day since hospitalization" class="time-profile-vis"></div>
                                </div>
                                <div class="form-group time-profile-group">
                                    <div class="flexinp">
                                        <div class="flextextinp">

                                            <input name="immune_susceptible_profile" id="immune_susceptible_profile" data-type="list" data-units="percent" class="time-profile-input" placeholder="E.g.  &quot;0, 1, 2&quot;" type="text"
                                                title="Probability per day than an immune person losses inmunity and becomses susceptible again" required>
                                            <div class="invalid-feedback">
                                                Please enter a coma separated list of numbers between 0 and 100.
                                            </div>
                                        </div>
                                        <button type="button" class="reset-inp-btn btn btn-dark btn-sm">Reset original</button>
                                    </div>
                                    <label for="immune_susceptible_profile">Inmunity loss profile</label>
                                    <div class="form-group">
                                        <button type="button" class="multiply-btn btn btn-info btn-sm">Multiply input by</button>
                                        <input type="number" class="multiply-inp" min="0" step="0.1" value="1" />
                                    </div>
                                    <div id="immune-susceptible-vis" data-xlabel="day since healing" class="time-profile-vis"></div>
                                </div>


                            </fieldset>
                            <fieldset class="border">
                                <legend class="w-auto">Initial outbreak</legend>
                                <label for="initial_outbreak_size">Inital outbreak size</label>
                                <input type="number" name="initial_outbreak_size" id="initial_outbreak_size" min="1" required>
                            </fieldset>
                            <fieldset class="border">
                                <legend class="w-auto">Population structure</legend>
                                <div class="form-group">
                                    <label for="total_population">Total population size</label>
                                    <input name="total_population" type="number" min="1" id="total_population" step="1" placeholder="E.g. 300000"
                                        data-toggle="tooltip" title="Total number of agents in the simulation"
                                        required></input>
                                    <div class="invalid-feedback">
                                        Please enter a positive number.
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="hospital_capacity">Hospital capacity</label>
                                    <input name="hospital_capacity" type="number" min="1" id="hospital_capacity" step="1" placeholder="E.g. 300000"
                                        data-toggle="tooltip" title="Hospital capacity"
                                        required></input>
                                    <div class="invalid-feedback">
                                        Please enter a positive number.
                                    </div>
                                    <fieldset class="border form-group">
                                        <legend class="w-auto">Household size distribution</legend>
                                        <div class="form-group">
                                            <label for="family_sizes">Sizes (Number of inhabitants)</label>
                                            <input name="family_sizes" id="family_sizes" data-type="list" type="text" placeholder="E.g. 1, 2, 3, 4, 5"
                                                data-toggle="tooltip" , title="Coma separated list of household sizes"
                                                required></input>
                                            <div class="invalid-feedback">
                                                Size and weights should be list of positive numbers of the same length.
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="family_size_weights">Relative weights</label>
                                            <input name="family_size_weights" id="family_size_weights" data-type="list" type="text" placeholder="E.g. 25, 30, 20, 10, 5"
                                                data-toggle="tooltip" , title="Coma separated list of household sizes"
                                                required></input>
                                            <div class="invalid-feedback">
                                                Size and weights should be list of positive numbers of the same length.
                                            </div>
                                        </div>
                                        <div id="family-dist-vis" class="time-profile-vis">

                                        </div>
                                        <div class="form-group">
                                            <label for="family_contact_undetected_coef">Infectability
                                                strength (Undetected)</label>
                                            <input name="family_contact_undetected_coef" id="family_contact_undetected_coef"
                                                type="number" min="0" max="1" step="any"
                                                placeholder="E.g. 1.0"
                                                title="Relative frequency of infection when an undetected infected person interacts with a susceptible family member."
                                                required />
                                            <div class=" invalid-feedback">
                                                Please enter a number between 0 and 1.
                                            </div>

                                        </div>
                                        <div class="form-group">
                                            <label for="family_contact_detected_coef">Infectability
                                                strength (Detected)</label>
                                            <input name="family_contact_detected_coef" id="family_contact_detected_coef"
                                                type="number" min="0" max=1 step="any"
                                                placeholder="E.g. 0.3"
                                                title="Relative frequency of infection when a detected infected person interacts with a family member."
                                                required />
                                            <div class=" invalid-feedback">
                                                Please enter a number between 0 and 1.
                                            </div>

                                        </div>

                                    </fieldset>
                                    <fieldset class="border">
                                        <legend class="w-auto">Workplace distribution</legend>
                                        <div class="form-group">
                                            <label for="average_workplace_size">Average workplace size</label>
                                            <input name="average_workplace_size" id="average_workplace_size" min="1" type="number" placeholder="E.g. 15"
                                                data-toggle="tooltip" title="Average number of workers per workplace"
                                                required></input>
                                            <div class="invalid-feedback">
                                                Please enter a positive number.
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="workplace_connectivity">Workplace
                                                connectivity</label>
                                            <input name="workplace_connectivity" id="workplace_connectivity" min="0" max="100" step="any" type="number"
                                                placeholder="E.g. 80" data-units="percent" data-toggle="tooltip"
                                                title="Percent probablity of two coworkers of being connected" required>
                                            <div class="invalid-feedback">
                                                Please enter a number between 0 and 1.
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="workplace_contact_undetected_coef">Infectability
                                                strength (Undetected)</label>
                                            <input name="workplace_contact_undetected_coef" id="workplace_contact_undetected_coef"
                                                type="number" min="0" max="1" step="any"
                                                placeholder="E.g. 0.8"
                                                title="Relative frequency of infection when an undetected infected person interacts with a susceptible coworker."
                                                required />
                                            <div class=" invalid-feedback">
                                                Please enter a positive number.
                                            </div>

                                        </div>
                                        <div class="form-group">
                                            <label for="workplace_contact_detected_coef">Infectability
                                                strength (Detected)</label>
                                            <input name="workplace_contact_detected_coef" id="workplace_contact_detected_coef"
                                                type="number" min="0" max="1" step="any"
                                                placeholder="E.g. 0.2"
                                                title="Relative frequency of infection when a detected infected person interacts with a susceptible one."
                                                required />
                                            <div class=" invalid-feedback">
                                                Please enter a positive number.
                                            </div>

                                        </div>

                                    </fieldset>
                                    <fieldset class="border">
                                        <legend class="w-auto">General connectivity settings</legend>
                                        <div class="form-group">
                                            <label for="average_world_connections">
                                                Average number of random connections
                                            </label>
                                            <input name="average_world_connections" id="average_world_connections" type="number" min="0"
                                                placeholder="E.g. 100"
                                                title="Average number of people that each person encounters daily"
                                                required></input>
                                            <div class="invalid-feedback">Please enter a positive number</div>

                                        </div>
                                        <div class="form-group">
                                            <label for="world_contact_undetected_coef">Infectability
                                                strength (Undetected)</label>
                                            <input name="world_contact_undetected_coef" id="world_contact_undetected_coef"
                                                type="number" min="0" max="1" step="any"
                                                placeholder="E.g. 0.1"
                                                title="Relative frequency of infection when an undetected infected person interacts with a susceptible one."
                                                required />
                                            <div class=" invalid-feedback">
                                                Please enter a number between 0 and 1.
                                            </div>

                                        </div>
                                        <div class="form-group">
                                            <label for="world_contact_detected_coef">Infectability
                                                strength (Detected)</label>
                                            <input name="world_contact_detected_coef" id="world_contact_detected_coef"
                                                type="number" min="0" max="1" step="any"
                                                placeholder="E.g. 0.01"
                                                title="Relative frequency of infection when a detected infected person interacts with a susceptible one."
                                                required />
                                            <div class=" invalid-feedback">
                                                Please enter a number between 0 and 1.
                                            </div>

                                        </div>

                                    </fieldset>
                            </fieldset>
                            <button type="button" id="configure-close" data-invalid="Please enter valid data in the form" data-valid="Done"
                                class="btn btn-secondary" data-toggle="collapse" data-target="#configure-collapse" aria-expanded="false"
                                aria-controls="configure-collapse">Done</button>
                            <div class="invalid-feedback">
                                Please enter valid data in the form.
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <button id="play-pause" class="btn btn-primary btn-lg"></button>
            <button id="reset" class="btn btn-secondary" disabled="true">⏹</button>



        </section>
        <div class="py-lg-5 bg-light">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 core-vis" id="vis"></div>
                    <div class="col-md-6 core-vis" id="vis-severe"></div>
                </div>

                <div class="row">
                    <div class="col-md-4 core-vis vis-daily" data-cat="Infected (Undetected)"></div>
                    <div class="col-md-4 core-vis vis-daily" data-cat="Infected (Detected)"></div>
                    <div class="col-md-4 core-vis vis-daily" data-cat="Severe"></div>
                    <div class="col-md-4 core-vis vis-daily" data-cat="Dead"></div>
                    <div class="col-md-4 core-vis vis-daily" data-cat="Immune"></div>
                    <div class="col-md-4 core-vis vis-daily" data-cat="Susceptible"></div>
                </div>
                <div class="row">
                    <div class="col">
                        <pre id="display" class="text-center">The simulation may consume your CPU resources.</pre>
                    </div>
                </div>
                <div colass="row">
                    <div class="col-md-12">
                        <p class="text-center lead">Share the settings of this simulation</p>
                    </div>
                    <div class="col-md-12 text-center">
                        <button id="copyurl" class="btn btn-primary">Copy URL</button>
                    </div>
                    <div class="col-md-12">
                        <input readonly="" id="urlshare" class="text-center"></input>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="text-muted">
        <div class="container">
            Zahari Kassabov
        </div>
    </footer>
    <script src="./index.js"></script>
</body>

</html>